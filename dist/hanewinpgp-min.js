/**
 * hanewinpgp - PGP / GnuPG / OpenPGP Message Encryption in JavaScript by Herbert Hanewinkel.
 * @version v0.1.0
 * @link https://github.com/dossy/hanewinpgp#readme
 * @license SEE LICENSE IN LICENSE
 */
"use strict";function hex2s(r){var t="";r.length%2&&(r+="0");for(var e=0;e<r.length;e+=2)t+=String.fromCharCode(parseInt(r.slice(e,e+2),16));return t}function crc24(r){for(var t=11994318,e=0;e<r.length;e++){t^=(255&r.charCodeAt(e))<<16;for(var n=0;n<8;n++)t<<=1,16777216&t&&(t^=25578747)}return String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t)}function GPGencrypt(r,t){var e,n,o=t.length,a=(r.length,new Array(bpbl)),i=new Array(bpbl),h=new Array(bpbl+2),s=new Array,c="";if(o%bpbl)for(e=o%bpbl;e<bpbl;e++)t+="\0";for(s=keyExpansion(r),e=0;e<bpbl;e++)a[e]=0,i[e]=randomByte();for(a=AESencrypt(a,s),e=0;e<bpbl;e++)h[e]=a[e]^=i[e];for(a=AESencrypt(a,s),h[bpbl]=a[0]^i[bpbl-2],h[bpbl+1]=a[1]^i[bpbl-1],e=0;e<bpbl+2;e++)c+=String.fromCharCode(h[e]);for(a=h.slice(2,bpbl+2),n=0;n<t.length;n+=bpbl)for(a=AESencrypt(a,s),e=0;e<bpbl;e++)a[e]^=t.charCodeAt(n+e),c+=String.fromCharCode(a[e]);return c.substr(0,o+bpbl+2)}function GPGpkt(r,t){t>255&&(r+=1);var e=String.fromCharCode(r);return t>255&&(e+=String.fromCharCode(t/256)),e+=String.fromCharCode(t%256)}function GPGpkesk(r,t,e,n,o){var a=new Array,i=new Array,h="",s=r2s(o),c=Math.floor((256*s.charCodeAt(0)+s.charCodeAt(1)+7)/8);if(a=mpi2b(s.substr(0,c+2)),t){var b=new Array,f=new Array,d=new Array,u=new Array,l=Math.floor((256*s.charCodeAt(c+2)+s.charCodeAt(c+3)+7)/8)+2;b=mpi2b(s.substr(c+2,l)),f=mpi2b(s.substr(c+2+l)),i[0]=9,d=bmodexp(b,i,a),u=bmodexp(f,i,a)}else i=mpi2b(s.substr(c+2));for(var m=n.length,p=0,C=0;C<m;C++)p+=n.charCodeAt(C);p&=65535;var g=8*(c-2)+2,v=String.fromCharCode(g/256)+String.fromCharCode(g%256)+String.fromCharCode(2)+randomString(c-m-6,1)+"\0"+String.fromCharCode(e)+n+String.fromCharCode(p/256)+String.fromCharCode(255&p);return t?(h=b2mpi(d)+b2mpi(bmod(bmul(mpi2b(v),u),a)),GPGpkt(132,h.length+10)+String.fromCharCode(3)+r+String.fromCharCode(16)+h):(h=b2mpi(bmodexp(mpi2b(v),i,a)),GPGpkt(132,h.length+10)+String.fromCharCode(3)+r+String.fromCharCode(1)+h)}function GPGld(r){return r.indexOf("\r\n")==-1&&(r=r.replace(/\n/g,"\r\n")),GPGpkt(172,r.length+10)+"t"+String.fromCharCode(4)+"file\0\0\0\0"+r}function GPGsed(r,t){var e=GPGencrypt(r,GPGld(t));return GPGpkt(164,e.length)+e}function doEncrypt(r,t,e,n){var o=7,a=[16,24,32],i=a[o-7],h=randomString(i,0);r=hex2s(r);var s=GPGpkesk(r,t,o,h,e)+GPGsed(h,n);return"-----BEGIN PGP MESSAGE-----\nVersion: haneWIN JavascriptPG v2.0\n\n"+s2r(s)+"\n="+s2r(crc24(s))+"\n-----END PGP MESSAGE-----\n"}function s2hex(r){for(var t="",e=0;e<r.length;e++){var n=r.charCodeAt(e);t+=(n<16?"0":"")+n.toString(16)}return t}function getPublicKey(r){var t,e=0,n=r.indexOf("-----BEGIN PGP PUBLIC KEY BLOCK-----");if(n==-1)return alert("No PGP Public Key Block"),this.vers="",this.fp="",this.keyid="",this.user="",void(this.pkey="");var o=r.indexOf("\n\n",n);o>0?o+=2:(o=r.indexOf("\n\r\n",n),o>0&&(o+=3));var a=r.indexOf("\n=",n);if(!(o>0&&a>0))return alert("Invalid PGP Public Key Block"),this.vers="",this.fp="",this.keyid="",this.user="",void(this.pkey="");r=r.slice(o,a);for(var i=r2s(r),n=0;n<i.length;){var h=i.charCodeAt(n++);if(0==(128&h))break;if(64&h?(h&=63,t=i.charCodeAt(n++),t>191&&t<224?t=(t-192<<8)+i.charCodeAt(n++):255==t?t=(i.charCodeAt(n++)<<24)+(i.charCodeAt(n++)<<16)+(i.charCodeAt(n++)<<8)+i.charCodeAt(n++):t>223&&t<255&&(t=1<<(31&t))):(t=3&h,h=h>>2&15,t=0==t?i.charCodeAt(n++):1==t?(i.charCodeAt(n++)<<8)+i.charCodeAt(n++):2==t?(i.charCodeAt(n++)<<24)+(i.charCodeAt(n++)<<16)+(i.charCodeAt(n++)<<8)+i.charCodeAt(n++):i.length-1),6==h||14==h){var s=n,c=i.charCodeAt(n++);e=1,this.vers=c;(i.charCodeAt(n++)<<24)+(i.charCodeAt(n++)<<16)+(i.charCodeAt(n++)<<8)+i.charCodeAt(n++);if(2==c||3==c){i.charCodeAt(n++)<<8+i.charCodeAt(n++)}var b=i.charCodeAt(n++);if(1==b||2==b){var f=n,d=Math.floor((256*i.charCodeAt(n)+i.charCodeAt(n+1)+7)/8);n+=d+2;var u=i.substr(f,d+2),l=Math.floor((256*i.charCodeAt(n)+i.charCodeAt(n+1)+7)/8);if(n+=l+2,this.pkey=s2r(i.substr(f,d+l+4)),this.type="RSA",3==c)this.fp="",this.keyid=s2hex(u.substr(u.length-8,8));else if(4==c){var m=String.fromCharCode(153)+String.fromCharCode(t>>8)+String.fromCharCode(255&t)+i.substr(s,t),p=str_sha1(m);this.fp=s2hex(p),this.keyid=s2hex(p.substr(p.length-8,8))}else this.fp="",this.keyid="";e=2}else if(16!=b&&20!=b||4!=c)n=s+t;else{var f=n,C=Math.floor((256*i.charCodeAt(n)+i.charCodeAt(n+1)+7)/8);n+=C+2;var g=Math.floor((256*i.charCodeAt(n)+i.charCodeAt(n+1)+7)/8);n+=g+2;var v=Math.floor((256*i.charCodeAt(n)+i.charCodeAt(n+1)+7)/8);n+=v+2,this.pkey=s2r(i.substr(f,C+g+v+6));var m=String.fromCharCode(153)+String.fromCharCode(t>>8)+String.fromCharCode(255&t)+i.substr(s,t),p=str_sha1(m);this.fp=s2hex(p),this.keyid=s2hex(p.substr(p.length-8,8)),this.type="ELGAMAL",e=3}}else 13==h?(this.user=i.substr(n,t),n+=t):n+=t}e<2&&(this.vers="",this.fp="",this.keyid="",0==e?this.user="No public key packet found.":1==e&&(this.user="public key algorithm is "+b+" not RSA or ELGAMAL."),this.pkey="")}function B0(r){return 255&r}function B1(r){return r>>8&255}function B2(r){return r>>16&255}function B3(r){return r>>24&255}function F1(r,t,e,n){return B1(T1[255&r])|B1(T1[t>>8&255])<<8|B1(T1[e>>16&255])<<16|B1(T1[n>>>24])<<24}function packBytes(r){var t,e,n=r.length,o=new Array(n/4);if(r&&!(n%4)){for(t=0,e=0;e<n;e+=4)o[t++]=r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24;return o}}function unpackBytes(r){var t,e=0,n=r.length,o=new Array(4*n);for(t=0;t<n;t++)o[e++]=B0(r[t]),o[e++]=B1(r[t]),o[e++]=B2(r[t]),o[e++]=B3(r[t]);return o}function keyExpansion(r){var t,e,n,o,a,i,h=new Array(maxrk+1),s=r.length,c=new Array(maxkc),b=new Array(maxkc),f=0;if(16==s)i=10,t=4;else if(24==s)i=12,t=6;else{if(32!=s)return void alert("Invalid AES key length "+s);i=14,t=8}for(e=0;e<maxrk+1;e++)h[e]=new Array(4);for(e=0,n=0;n<s;n++,e+=4)c[n]=r.charCodeAt(e)|r.charCodeAt(e+1)<<8|r.charCodeAt(e+2)<<16|r.charCodeAt(e+3)<<24;for(n=t-1;n>=0;n--)b[n]=c[n];for(o=0,a=0,n=0;n<t&&o<i+1;){for(;n<t&&a<4;n++,a++)h[o][a]=b[n];4==a&&(o++,a=0)}for(;o<i+1;){var d=b[t-1];if(b[0]^=S[B1(d)]|S[B2(d)]<<8|S[B3(d)]<<16|S[B0(d)]<<24,b[0]^=Rcon[f++],8!=t)for(n=1;n<t;n++)b[n]^=b[n-1];else{for(n=1;n<t/2;n++)b[n]^=b[n-1];for(d=b[t/2-1],b[t/2]^=S[B0(d)]|S[B1(d)]<<8|S[B2(d)]<<16|S[B3(d)]<<24,n=t/2+1;n<t;n++)b[n]^=b[n-1]}for(n=0;n<t&&o<i+1;){for(;n<t&&a<4;n++,a++)h[o][a]=b[n];4==a&&(o++,a=0)}}return{rounds:i,rk:h}}function AESencrypt(r,t){var e,n,o,a,i,h=packBytes(r),s=t.rounds,c=h[0],b=h[1],f=h[2],d=h[3];for(e=0;e<s-1;e++)n=c^t.rk[e][0],o=b^t.rk[e][1],a=f^t.rk[e][2],i=d^t.rk[e][3],c=T1[255&n]^T2[o>>8&255]^T3[a>>16&255]^T4[i>>>24],b=T1[255&o]^T2[a>>8&255]^T3[i>>16&255]^T4[n>>>24],f=T1[255&a]^T2[i>>8&255]^T3[n>>16&255]^T4[o>>>24],d=T1[255&i]^T2[n>>8&255]^T3[o>>16&255]^T4[a>>>24];return e=s-1,n=c^t.rk[e][0],o=b^t.rk[e][1],a=f^t.rk[e][2],i=d^t.rk[e][3],h[0]=F1(n,o,a,i)^t.rk[s][0],h[1]=F1(o,a,i,n)^t.rk[s][1],h[2]=F1(a,i,n,o)^t.rk[s][2],h[3]=F1(i,n,o,a)^t.rk[s][3],unpackBytes(h)}function s2r(r){var t,e,n,o="",a=0,i=0,h=r.length;for(n=0;n<h;n++)e=r.charCodeAt(n),0==i?(o+=b64s.charAt(e>>2&63),t=(3&e)<<4):1==i?(o+=b64s.charAt(t|e>>4&15),t=(15&e)<<2):2==i&&(o+=b64s.charAt(t|e>>6&3),a+=1,a%60==0&&(o+="\n"),o+=b64s.charAt(63&e)),a+=1,a%60==0&&(o+="\n"),i+=1,3==i&&(i=0);return i>0&&(o+=b64s.charAt(t),a+=1,a%60==0&&(o+="\n"),o+="=",a+=1),1==i&&(a%60==0&&(o+="\n"),o+="="),o}function r2s(r){var t,e,n="",o=0,a=0,i=r.length;for(e=0;e<i;e++)t=b64s.indexOf(r.charAt(e)),t>=0&&(o&&(n+=String.fromCharCode(a|t>>6-o&255)),o=o+2&7,a=t<<o&255);return n}function zeros(r){for(var t=new Array(r);r-- >0;)t[r]=0;return t}function zclip(r){var t=r.length;if(r[t-1])return r;for(;t>1&&0==r[t-1];)t--;return r.slice(0,t)}function nbits(r){var t,e=1;return 0!=(t=r>>>16)&&(r=t,e+=16),0!=(t=r>>8)&&(r=t,e+=8),0!=(t=r>>4)&&(r=t,e+=4),0!=(t=r>>2)&&(r=t,e+=2),0!=(t=r>>1)&&(r=t,e+=1),e}function badd(r,t){var e=r.length,n=t.length;if(e<n)return badd(t,r);for(var o=new Array(e),a=0,i=0;i<n;i++)a+=r[i]+t[i],o[i]=a&bm,a>>>=bs;for(;i<e;i++)a+=r[i],o[i]=a&bm,a>>>=bs;return a&&(o[i]=a),o}function bsub(r,t){var e=r.length,n=t.length;if(n>e)return[];if(n==e){if(t[n-1]>r[n-1])return[];if(1==n)return[r[0]-t[0]]}for(var o=new Array(e),a=0,i=0;i<n;i++)a+=r[i]-t[i],o[i]=a&bm,a>>=bs;for(;i<e;i++)a+=r[i],o[i]=a&bm,a>>=bs;return a?[]:zclip(o)}function ip(r,t,e,n,o){var a=e&bdm,i=e>>bd,h=n&bdm,s=n>>bd,c=i*h+s*a,b=a*h+((c&bdm)<<bd)+r[t]+o;return r[t]=b&bm,o=i*s+(c>>bd)+(b>>bs)}function bsqr(r){var t,e,n=r.length,o=2*n,a=zeros(o),i=0;for(t=0;t<n;t++){for(i=ip(a,2*t,r[t],r[t],0),e=t+1;e<n;e++)i=ip(a,t+e,2*r[e],r[t],i);a[t+n]=i}return zclip(a)}function bmul(r,t){var e,n,o,a=r.length,i=t.length,h=zeros(a+i-1);for(n=0;n<i;n++){for(e=0,o=0;o<a;o++)e=ip(h,n+o,r[o],t[n],e);h[n+a]=e}return zclip(h)}function toppart(r,t,e){for(var n=0;t>=0&&e-- >0;)n=n*bx2+r[t--];return n}function bdiv(r,t){var e=r.length-1,n=t.length-1,o=e-n;if(e<n||e==n&&(r[e]<t[e]||e>0&&r[e]==t[e]&&r[e-1]<t[e-1]))return{q:[0],mod:r};if(e==n&&toppart(r,n,2)/toppart(t,n,2)<4){for(var a,i=r.concat(),h=0;a=bsub(i,t),0!=a.length;)i=a,h++;return{q:[h],mod:i}}var s=Math.floor(Math.log(t[n])/log2)+1,c=bs-s,i=r.concat(),b=t.concat();if(c){for(f=n;f>0;f--)b[f]=b[f]<<c&bm|b[f-1]>>s;for(b[0]=b[0]<<c&bm,i[e]&(bm<<s&bm)&&(i[++e]=0,o++),f=e;f>0;f--)i[f]=i[f]<<c&bm|i[f-1]>>s;i[0]=i[0]<<c&bm}for(var f,d,u=zeros(o+1),l=zeros(o).concat(b);d=bsub(i,l),0!=d.length;)u[o]++,i=d;var m=b[n],p=toppart(b,n,2);for(f=e;f>n;f--){var C=f-n-1;f>=i.length?u[C]=1:i[f]==m?u[C]=bm:u[C]=Math.floor(toppart(i,f,2)/m);for(var g=toppart(i,f,3);u[C]*p>g;)u[C]--;l=l.slice(1),d=bsub(i,bmul([u[C]],l)),0==d.length&&(u[C]--,d=bsub(i,bmul([u[C]],l))),i=d}if(c){for(f=0;f<i.length-1;f++)i[f]=i[f]>>c|i[f+1]<<s&bm;i[i.length-1]>>=c}return{q:zclip(u),mod:zclip(i)}}function simplemod(r,t){for(var e,n=0,o=r.length-1;o>=0;o--)e=r[o],n=((e>>bd)+(n<<bd))%t,n=((e&bdm)+(n<<bd))%t;return n}function bmod(r,t){if(1==t.length){if(1==r.length)return[r[0]%t[0]];if(t[0]<bdm)return[simplemod(r,t[0])]}var e=bdiv(r,t);return e.mod}function bmod2(r,t,e){var n=r.length-(t.length<<1);if(n>0)return bmod2(r.slice(0,n).concat(bmod2(r.slice(n),t,e)),t,e);var o,a=t.length+1,i=t.length-1,h=bmul(r.slice(i),e).slice(a),s=r.slice(0,a),c=bmul(h,t).slice(0,a),b=bsub(s,c);0==b.length&&(s[a]=1,b=bsub(s,c));for(var f=0;o=bsub(b,t),0!=o.length;f++)if(b=o,f>=3)return bmod2(b,t,e);return b}function bexpmod(r,t,e){for(var n=r.concat(),o=t.length-1,a=nbits(t[o])-2;o>=0;o--){for(;a>=0;a-=1)n=bmod(bsqr(n),e),t[o]&1<<a&&(n=bmod(bmul(n,r),e));a=bs-1}return n}function bmodexp(r,t,e){var n=r.concat(),o=t.length-1,a=2*e.length,i=zeros(a+1);for(i[a]=1,i=bdiv(i,e).q,a=nbits(t[o])-2;o>=0;o--){for(;a>=0;a-=1)n=bmod2(bsqr(n),e,i),t[o]&1<<a&&(n=bmod2(bmul(n,r),e,i));a=bs-1}return n}function RSAencrypt(r,t,e){return bexpmod(r,t,e)}function RSAdecrypt(r,t,e,n,o){var a=bmodexp(bmod(r,e),bmod(t,bsub(e,[1])),e),i=bmodexp(bmod(r,n),bmod(t,bsub(n,[1])),n),h=bsub(i,a);return 0==h.length?(h=bsub(a,i),h=bmod(bmul(h,o),n),h=bsub(n,h)):h=bmod(bmul(h,o),n),badd(bmul(h,e),a)}function mpi2b(r){var t,e=1,n=[0],o=0,a=256,i=r.length;if(i<2)return alert("string too short, not a MPI"),0;var h=8*(i-2),s=256*r.charCodeAt(0)+r.charCodeAt(1);if(s>h||s<h-8)return alert("not a MPI, bits="+s+",len="+h),0;for(var c=0;c<h;c++)(a<<=1)>255&&(a=1,t=r.charCodeAt(--i)),e>bm&&(e=1,n[++o]=0),t&a&&(n[o]|=e),e<<=1;return n}function b2mpi(r){var t,e=1,n=0,o=[0],a=1,i=0,h=r.length*bs,s="";for(t=0;t<h;t++)r[n]&e&&(o[i]|=a),(a<<=1)>255&&(a=1,o[++i]=0),(e<<=1)>bm&&(e=1,n++);for(;i&&0==o[i];)i--;for(e=256,h=8;h>0&&!(o[i]&(e>>=1));h--);if(h+=8*i,s+=String.fromCharCode(h/256)+String.fromCharCode(h%256),h)for(t=i;t>=0;t--)s+=String.fromCharCode(o[t]);return s}function hex_sha1(r){return binb2hex(core_sha1(str2binb(r),r.length*chrsz))}function b64_sha1(r){return binb2b64(core_sha1(str2binb(r),r.length*chrsz))}function str_sha1(r){return binb2str(core_sha1(str2binb(r),r.length*chrsz))}function hex_hmac_sha1(r,t){return binb2hex(core_hmac_sha1(r,t))}function b64_hmac_sha1(r,t){return binb2b64(core_hmac_sha1(r,t))}function str_hmac_sha1(r,t){return binb2str(core_hmac_sha1(r,t))}function sha1_vm_test(){return"a9993e364706816aba3e25717850c26c9cd0d89d"==hex_sha1("abc")}function core_sha1(r,t){r[t>>5]|=128<<24-t%32,r[(t+64>>9<<4)+15]=t;for(var e=Array(80),n=1732584193,o=-271733879,a=-1732584194,i=271733878,h=-1009589776,s=0;s<r.length;s+=16){for(var c=n,b=o,f=a,d=i,u=h,l=0;l<80;l++){l<16?e[l]=r[s+l]:e[l]=rol(e[l-3]^e[l-8]^e[l-14]^e[l-16],1);var m=safe_add(safe_add(rol(n,5),sha1_ft(l,o,a,i)),safe_add(safe_add(h,e[l]),sha1_kt(l)));h=i,i=a,a=rol(o,30),o=n,n=m}n=safe_add(n,c),o=safe_add(o,b),a=safe_add(a,f),i=safe_add(i,d),h=safe_add(h,u)}return Array(n,o,a,i,h)}function sha1_ft(r,t,e,n){return r<20?t&e|~t&n:r<40?t^e^n:r<60?t&e|t&n|e&n:t^e^n}function sha1_kt(r){return r<20?1518500249:r<40?1859775393:r<60?-1894007588:-899497514}function core_hmac_sha1(r,t){var e=str2binb(r);e.length>16&&(e=core_sha1(e,r.length*chrsz));for(var n=Array(16),o=Array(16),a=0;a<16;a++)n[a]=909522486^e[a],o[a]=1549556828^e[a];var i=core_sha1(n.concat(str2binb(t)),512+t.length*chrsz);return core_sha1(o.concat(i),672)}function safe_add(r,t){var e=(65535&r)+(65535&t),n=(r>>16)+(t>>16)+(e>>16);return n<<16|65535&e}function rol(r,t){return r<<t|r>>>32-t}function str2binb(r){for(var t=Array(),e=(1<<chrsz)-1,n=0;n<r.length*chrsz;n+=chrsz)t[n>>5]|=(r.charCodeAt(n/chrsz)&e)<<24-n%32;return t}function binb2str(r){for(var t="",e=(1<<chrsz)-1,n=0;n<32*r.length;n+=chrsz)t+=String.fromCharCode(r[n>>5]>>>24-n%32&e);return t}function binb2hex(r){for(var t=hexcase?"0123456789ABCDEF":"0123456789abcdef",e="",n=0;n<4*r.length;n++)e+=t.charAt(r[n>>2]>>8*(3-n%4)+4&15)+t.charAt(r[n>>2]>>8*(3-n%4)&15);return e}function binb2b64(r){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e="",n=0;n<4*r.length;n+=3)for(var o=(r[n>>2]>>8*(3-n%4)&255)<<16|(r[n+1>>2]>>8*(3-(n+1)%4)&255)<<8|r[n+2>>2]>>8*(3-(n+2)%4)&255,a=0;a<4;a++)e+=8*n+6*a>32*r.length?b64pad:t.charAt(o>>6*(3-a)&63);return e}var randomByte;try{const crypto=require("crypto");randomByte=function(){return crypto.randomBytes(1)[0]}}catch(e){const Random=require("random-js");randomByte=Random.engines.browserCrypto?function(){return Random.integer(0,255)(Random.engines.browserCrypto)}:function(){return Random.integer(0,255)(Random.engines.nativeMath)}}var randomString=function(r,t){for(var e,n=[],o=0;o<r;)e=randomByte(),0==e&&t||(o++,n.push(String.fromCharCode(e)));return n.join("")},bpbl=16;module.exports.encrypt=function(r,t){return doEncrypt(r.id,r.type,r.key,t)};var stop=!1;module.exports.stop=function(){stop=!0},module.exports.extract=function(r){var t=new getPublicKey(r);return{version:t.vers,user:t.user,id:t.keyid,type:"RSA"==t.type?0:1,key:t.pkey.replace(/\n/g,"")}};var Rcon=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],S=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],T1=[2774754246,2222750968,2574743534,2373680118,234025727,3177933782,2976870366,1422247313,1345335392,50397442,2842126286,2099981142,436141799,1658312629,3870010189,2591454956,1170918031,2642575903,1086966153,2273148410,368769775,3948501426,3376891790,200339707,3970805057,1742001331,4255294047,3937382213,3214711843,4154762323,2524082916,1539358875,3266819957,486407649,2928907069,1780885068,1513502316,1094664062,49805301,1338821763,1546925160,4104496465,887481809,150073849,2473685474,1943591083,1395732834,1058346282,201589768,1388824469,1696801606,1589887901,672667696,2711000631,251987210,3046808111,151455502,907153956,2608889883,1038279391,652995533,1764173646,3451040383,2675275242,453576978,2659418909,1949051992,773462580,756751158,2993581788,3998898868,4221608027,4132590244,1295727478,1641469623,3467883389,2066295122,1055122397,1898917726,2542044179,4115878822,1758581177,0,753790401,1612718144,536673507,3367088505,3982187446,3194645204,1187761037,3653156455,1262041458,3729410708,3561770136,3898103984,1255133061,1808847035,720367557,3853167183,385612781,3309519750,3612167578,1429418854,2491778321,3477423498,284817897,100794884,2172616702,4031795360,1144798328,3131023141,3819481163,4082192802,4272137053,3225436288,2324664069,2912064063,3164445985,1211644016,83228145,3753688163,3249976951,1977277103,1663115586,806359072,452984805,250868733,1842533055,1288555905,336333848,890442534,804056259,3781124030,2727843637,3427026056,957814574,1472513171,4071073621,2189328124,1195195770,2892260552,3881655738,723065138,2507371494,2690670784,2558624025,3511635870,2145180835,1713513028,2116692564,2878378043,2206763019,3393603212,703524551,3552098411,1007948840,2044649127,3797835452,487262998,1994120109,1004593371,1446130276,1312438900,503974420,3679013266,168166924,1814307912,3831258296,1573044895,1859376061,4021070915,2791465668,2828112185,2761266481,937747667,2339994098,854058965,1137232011,1496790894,3077402074,2358086913,1691735473,3528347292,3769215305,3027004632,4199962284,133494003,636152527,2942657994,2390391540,3920539207,403179536,3585784431,2289596656,1864705354,1915629148,605822008,4054230615,3350508659,1371981463,602466507,2094914977,2624877800,555687742,3712699286,3703422305,2257292045,2240449039,2423288032,1111375484,3300242801,2858837708,3628615824,84083462,32962295,302911004,2741068226,1597322602,4183250862,3501832553,2441512471,1489093017,656219450,3114180135,954327513,335083755,3013122091,856756514,3144247762,1893325225,2307821063,2811532339,3063651117,572399164,2458355477,552200649,1238290055,4283782570,2015897680,2061492133,2408352771,4171342169,2156497161,386731290,3669999461,837215959,3326231172,3093850320,3275833730,2962856233,1999449434,286199582,3417354363,4233385128,3602627437,974525996],T2=[1667483301,2088564868,2004348569,2071721613,4076011277,1802229437,1869602481,3318059348,808476752,16843267,1734856361,724260477,4278118169,3621238114,2880130534,1987505306,3402272581,2189565853,3385428288,2105408135,4210749205,1499050731,1195871945,4042324747,2913812972,3570709351,2728550397,2947499498,2627478463,2762232823,1920132246,3233848155,3082253762,4261273884,2475900334,640044138,909536346,1061125697,4160222466,3435955023,875849820,2779075060,3857043764,4059166984,1903288979,3638078323,825320019,353708607,67373068,3351745874,589514341,3284376926,404238376,2526427041,84216335,2593796021,117902857,303178806,2155879323,3806519101,3958099238,656887401,2998042573,1970662047,151589403,2206408094,741103732,437924910,454768173,1852759218,1515893998,2694863867,1381147894,993752653,3604395873,3014884814,690573947,3823361342,791633521,2223248279,1397991157,3520182632,0,3991781676,538984544,4244431647,2981198280,1532737261,1785386174,3419114822,3200149465,960066123,1246401758,1280088276,1482207464,3486483786,3503340395,4025468202,2863288293,4227591446,1128498885,1296931543,859006549,2240090516,1162185423,4193904912,33686534,2139094657,1347461360,1010595908,2678007226,2829601763,1364304627,2745392638,1077969088,2408514954,2459058093,2644320700,943222856,4126535940,3166462943,3065411521,3671764853,555827811,269492272,4294960410,4092853518,3537026925,3452797260,202119188,320022069,3974939439,1600110305,2543269282,1145342156,387395129,3301217111,2812761586,2122251394,1027439175,1684326572,1566423783,421081643,1936975509,1616953504,2172721560,1330618065,3705447295,572671078,707417214,2425371563,2290617219,1179028682,4008625961,3099093971,336865340,3739133817,1583267042,185275933,3688607094,3772832571,842163286,976909390,168432670,1229558491,101059594,606357612,1549580516,3267534685,3553869166,2896970735,1650640038,2442213800,2509582756,3840201527,2038035083,3890730290,3368586051,926379609,1835915959,2374828428,3587551588,1313774802,2846444e3,1819072692,1448520954,4109693703,3941256997,1701169839,2054878350,2930657257,134746136,3132780501,2021191816,623200879,774790258,471611428,2795919345,3031724999,3334903633,3907570467,3722289532,1953818780,522141217,1263245021,3183305180,2341145990,2324303749,1886445712,1044282434,3048567236,1718013098,1212715224,50529797,4143380225,235805714,1633796771,892693087,1465364217,3115936208,2256934801,3250690392,488454695,2661164985,3789674808,4177062675,2560109491,286335539,1768542907,3654920560,2391672713,2492740519,2610638262,505297954,2273777042,3924412704,3469641545,1431677695,673730680,3755976058,2357986191,2711706104,2307459456,218962455,3216991706,3873888049,1111655622,1751699640,1094812355,2576951728,757946999,252648977,2964356043,1414834428,3149622742,370551866],T3=[1673962851,2096661628,2012125559,2079755643,4076801522,1809235307,1876865391,3314635973,811618352,16909057,1741597031,727088427,4276558334,3618988759,2874009259,1995217526,3398387146,2183110018,3381215433,2113570685,4209972730,1504897881,1200539975,4042984432,2906778797,3568527316,2724199842,2940594863,2619588508,2756966308,1927583346,3231407040,3077948087,4259388669,2470293139,642542118,913070646,1065238847,4160029431,3431157708,879254580,2773611685,3855693029,4059629809,1910674289,3635114968,828527409,355090197,67636228,3348452039,591815971,3281870531,405809176,2520228246,84545285,2586817946,118360327,304363026,2149292928,3806281186,3956090603,659450151,2994720178,1978310517,152181513,2199756419,743994412,439627290,456535323,1859957358,1521806938,2690382752,1386542674,997608763,3602342358,3011366579,693271337,3822927587,794718511,2215876484,1403450707,3518589137,0,3988860141,541089824,4242743292,2977548465,1538714971,1792327274,3415033547,3194476990,963791673,1251270218,1285084236,1487988824,3481619151,3501943760,4022676207,2857362858,4226619131,1132905795,1301993293,862344499,2232521861,1166724933,4192801017,33818114,2147385727,1352724560,1014514748,2670049951,2823545768,1369633617,2740846243,1082179648,2399505039,2453646738,2636233885,946882616,4126213365,3160661948,3061301686,3668932058,557998881,270544912,4293204735,4093447923,3535760850,3447803085,202904588,321271059,3972214764,1606345055,2536874647,1149815876,388905239,3297990596,2807427751,2130477694,1031423805,1690872932,1572530013,422718233,1944491379,1623236704,2165938305,1335808335,3701702620,574907938,710180394,2419829648,2282455944,1183631942,4006029806,3094074296,338181140,3735517662,1589437022,185998603,3685578459,3772464096,845436466,980700730,169090570,1234361161,101452294,608726052,1555620956,3265224130,3552407251,2890133420,1657054818,2436475025,2503058581,3839047652,2045938553,3889509095,3364570056,929978679,1843050349,2365688973,3585172693,1318900302,2840191145,1826141292,1454176854,4109567988,3939444202,1707781989,2062847610,2923948462,135272456,3127891386,2029029496,625635109,777810478,473441308,2790781350,3027486644,3331805638,3905627112,3718347997,1961401460,524165407,1268178251,3177307325,2332919435,2316273034,1893765232,1048330814,3044132021,1724688998,1217452104,50726147,4143383030,236720654,1640145761,896163637,1471084887,3110719673,2249691526,3248052417,490350365,2653403550,3789109473,4176155640,2553000856,287453969,1775418217,3651760345,2382858638,2486413204,2603464347,507257374,2266337927,3922272489,3464972750,1437269845,676362280,3752164063,2349043596,2707028129,2299101321,219813645,3211123391,3872862694,1115997762,1758509160,1099088705,2569646233,760903469,253628687,2960903088,1420360788,3144537787,371997206],T4=[3332727651,4169432188,4003034999,4136467323,4279104242,3602738027,3736170351,2438251973,1615867952,33751297,3467208551,1451043627,3877240574,3043153879,1306962859,3969545846,2403715786,530416258,2302724553,4203183485,4011195130,3001768281,2395555655,4211863792,1106029997,3009926356,1610457762,1173008303,599760028,1408738468,3835064946,2606481600,1975695287,3776773629,1034851219,1282024998,1817851446,2118205247,4110612471,2203045068,1750873140,1374987685,3509904869,4178113009,3801313649,2876496088,1649619249,708777237,135005188,2505230279,1181033251,2640233411,807933976,933336726,168756485,800430746,235472647,607523346,463175808,3745374946,3441880043,1315514151,2144187058,3936318837,303761673,496927619,1484008492,875436570,908925723,3702681198,3035519578,1543217312,2767606354,1984772923,3076642518,2110698419,1383803177,3711886307,1584475951,328696964,2801095507,3110654417,0,3240947181,1080041504,3810524412,2043195825,3069008731,3569248874,2370227147,1742323390,1917532473,2497595978,2564049996,2968016984,2236272591,3144405200,3307925487,1340451498,3977706491,2261074755,2597801293,1716859699,294946181,2328839493,3910203897,67502594,4269899647,2700103760,2017737788,632987551,1273211048,2733855057,1576969123,2160083008,92966799,1068339858,566009245,1883781176,4043634165,1675607228,2009183926,2943736538,1113792801,540020752,3843751935,4245615603,3211645650,2169294285,403966988,641012499,3274697964,3202441055,899848087,2295088196,775493399,2472002756,1441965991,4236410494,2051489085,3366741092,3135724893,841685273,3868554099,3231735904,429425025,2664517455,2743065820,1147544098,1417554474,1001099408,193169544,2362066502,3341414126,1809037496,675025940,2809781982,3168951902,371002123,2910247899,3678134496,1683370546,1951283770,337512970,2463844681,201983494,1215046692,3101973596,2673722050,3178157011,1139780780,3299238498,967348625,832869781,3543655652,4069226873,3576883175,2336475336,1851340599,3669454189,25988493,2976175573,2631028302,1239460265,3635702892,2902087254,4077384948,3475368682,3400492389,4102978170,1206496942,270010376,1876277946,4035475576,1248797989,1550986798,941890588,1475454630,1942467764,2538718918,3408128232,2709315037,3902567540,1042358047,2531085131,1641856445,226921355,260409994,3767562352,2084716094,1908716981,3433719398,2430093384,100991747,4144101110,470945294,3265487201,1784624437,2935576407,1775286713,395413126,2572730817,975641885,666476190,3644383713,3943954680,733190296,573772049,3535497577,2842745305,126455438,866620564,766942107,1008868894,361924487,3374377449,2269761230,2868860245,1350051880,2776293343,59739276,1509466529,159418761,437718285,1708834751,3610371814,2227585602,3501746280,2193834305,699439513,1517759789,504434447,2076946608,2835108948,1842789307,742004246],maxkc=8,maxrk=14,b64s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";const alert=function(r){throw new Error(r)};var bs=28,bx2=1<<bs,bm=bx2-1,bx=bx2>>1,bd=bs>>1,bdm=(1<<bd)-1,log2=Math.log(2),hexcase=0,b64pad="",chrsz=8;