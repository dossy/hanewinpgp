/**
 * hanewinpgp - PGP / GnuPG / OpenPGP Message Encryption in JavaScript by Herbert Hanewinkel.
 * @version v0.1.0
 * @link https://www.hanewin.net/encrypt/
 * @license ISC
 */
function str2hex(r){for(var e="0123456789abcdef",t="",n=0;n<r.length;n++)b=r.charCodeAt(n),t+=e.charAt(b>>>4&15)+e.charAt(15&b);return t}function hex2str(r){for(var e="",t=0;t<r.length;t+=2)e+=String.fromCharCode(parseInt(r.slice(t,t+2),16));return e}function GPGdecode(r,e){var t,n,o=r.length,a=new Array(bpbl),s=new Array(bpbl),i=new Array,h="";for(keySizeInBits=8*o,i=keyExpansion(r),t=0;t<bpbl;t++)a[t]=0;for(a=AESencrypt(a,i),t=0;t<bpbl;t++)s[t]=e.charCodeAt(t),a[t]^=s[t];if(s=AESencrypt(s,i),a[bpbl-2]!=(s[0]^e.charCodeAt(bpbl))||a[bpbl-1]!=(s[1]^e.charCodeAt(bpbl+1)))return alert("session key decryption failed"),h;for(t=0;t<bpbl;t++)a[t]=e.charCodeAt(t+2);for(n=bpbl+2;n<e.length;n+=bpbl)for(s=AESencrypt(a,i),t=0;t<bpbl;t++)a[t]=e.charCodeAt(n+t),h+=String.fromCharCode(s[t]^a[t]);return h}function doDecrypt(r,e,t,n,o){var a,s=0,i="";if(0==o.indexOf("-----BEGIN PGP")){var h=o.indexOf("\n");h>0&&(h=o.indexOf("\n",h+1));var c=o.indexOf("\n=");h>0&&c>0&&(o=o.slice(h+2,c))}for(var d=r2s(o);s<d.length;){i+="\n";var u=d.charCodeAt(s++);if(0==(128&u))break;64&u?(u&=63,a=d.charCodeAt(s++),a>191&&a<224?a=(a-192<<8)+d.charCodeAt(s++):a>223&&a<255?a=1<<(31&a):255==a&&(a=(d.charCodeAt(s++)<<24)+(d.charCodeAt(s++)<<16)+(d.charCodeAt(s++)<<8)+d.charCodeAt(s++)),i+="Tag:"+u):(a=3&u,u=u>>>2&15,i+="Tag:"+u+" Len-Type:"+a,a=0==a?d.charCodeAt(s++):1==a?(d.charCodeAt(s++)<<8)+d.charCodeAt(s++):2==a?(d.charCodeAt(s++)<<24)+(d.charCodeAt(s++)<<16)+(d.charCodeAt(s++)<<8)+d.charCodeAt(s++):d.length-s-1),i+=" Length:"+a;var l=s;if(1==u){i+=" => Public Key encrypted session key Packet\n";var f=d.charCodeAt(s++);i+="Version:"+f;var A=d.substr(s,8);i+=" KeyId:"+str2hex(A),s+=8;var b=d.charCodeAt(s++);if(i+=" Algorithm:"+b+"\n",b<1||b>3){alert("Session key is NOT RSA encrypted");break}var m=256*d.charCodeAt(s)+d.charCodeAt(s+1),y=Math.floor((m+7)/8),C=d.substr(s,y+2);s+=y+2;var p=b2mpi(RSAdecrypt(mpi2b(C),t,r,e,n));if(m=Math.floor((256*p.charCodeAt(0)+p.charCodeAt(1)+7)/8),m+2!=p.length){alert("RSA decryption of session key failed, MPI length");break}if(2!=p.charCodeAt(2)){alert("RSA decryption of session key failed, block type");break}for(X=3;X<p.length&&0!=p.charCodeAt(X++););if(X+3>=p.length){alert("RSA decryption of session key failed, zero byte");break}if(b=p.charCodeAt(X++),7!=b&&8!=b&&9!=b){alert("symmectric encryption not AES, AES192, AES256");break}seskey=p.substr(X,p.length-X-2);for(var v=0,k=0;k<seskey.length;k++)v+=seskey.charCodeAt(k);if(v&=65535,v!=256*p.charCodeAt(p.length-2)+p.charCodeAt(p.length-1)){alert("session key checksum failed");break}i+="Sessionkey:"+m+","+seskey.length+","+str2hex(seskey)+"\n"}else if(2==u)i+=" => Signature Packet\n";else if(3==u)i+=" => Symmetric-Key Encrypted Session Key Packet\n";else if(4==u)i+=" => One-Pass Signature Packet\n";else if(5==u){i+=" => Secret Key Packet\n";var f=d.charCodeAt(s++),g=(d.charCodeAt(s++)<<24)+(d.charCodeAt(s++)<<16)+(d.charCodeAt(s++)<<8)+d.charCodeAt(s++);if(i+="Version:"+f+" Created:"+g,3==f){var S=d.charCodeAt(s++)<<8+d.charCodeAt(s++);i+=" Valid:"+S}var b=d.charCodeAt(s++);if(i+=" Algorithm:"+b+"\n",b<1||b>3){alert("Algorithm is not RSA\n");break}var y=Math.floor((256*d.charCodeAt(s)+d.charCodeAt(s+1)+7)/8),C=mpi2b(d.substr(s,y+2));i+="PK-modulus:"+y+","+C+"\n",s+=y+2;var x=Math.floor((256*d.charCodeAt(s)+d.charCodeAt(s+1)+7)/8),B=mpi2b(d.substr(s,x+2));i+="PK-exp:"+x+","+B+"\n",s+=x+2;var w=d.charCodeAt(s++),E=0,P=0,M=1,p="",G="";if(i+="SK-Encryption:"+w+"\n",0!=w)if(255==w||254==w){if(P=d.charCodeAt(s++),i+="SK-CipherAlgorithm:"+P+"\n",E=d.charCodeAt(s++),M=d.charCodeAt(s++),i+="SK-S2K:"+E+" SK-HashAlgorithm:"+M+"\n",2!=M&&alert("only SHA-1 implemented"),0==E)G=window.prompt("Password:",""),2==M&&(p=str_sha1(G));else if(1==E)G=d.substr(s,8)+window.prompt("Password:",""),i+="salt:"+d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++),2==M&&(p=str_sha1(G));else if(3==E){G=d.substr(s,8)+window.prompt("Password:",""),i+="salt:"+d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++);var _=d.charCodeAt(s);_=16+(15&_)<<(_>>>4&15)+6;for(var K=G;K.length<_;)K+=G;i+="\nSalt+Password Length:"+G.length+" ISP:"+K.length,G.length<_&&(K=K.substr(0,_)),i+=" count:"+d.charCodeAt(s++)+"=>"+_,2==M&&(p=str_sha1(K))}i+="\nKey:";for(var T=new Array(16),k=0;k<16;k++)T[k]=p.charCodeAt(k),i+=" "+T[k];i+="\n";for(var z=new Array(8),R=new Array(8),k=0;k<8;k++)R[k]=d.charCodeAt(s+k);i+="IV:"+d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++)+ +d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++)+","+d.charCodeAt(s++)+"\n";var N=l+a-s;i+="Encrypted data length:"+N+"\n";for(var I=new cast5(T),o="",O=s;O<l+a;O+=8)for(z=I.Encrypt(R),k=0;k<8&&!(O+k>=l+a);k++)R[k]=d.charCodeAt(O+k),o+=String.fromCharCode(z[k]^R[k]);if(254==w){N-=20;var O,L=str_sha1(o.substr(0,N));for(O=0;O<20;O++)if(L.charCodeAt(O)!=o.charCodeAt(N+O)){i+="SHA-1 check failed, wrong Password?\n";break}20==O&&(i+="SHA-1 check ok\n")}else{N-=2;for(var q=0,O=0;O<N;O++)q+=o.charCodeAt(O);var H=256*o.charCodeAt(N)+o.charCodeAt(N+1);i+=(65535&q)==H?"checksum ok\n":"checksum failed\n"}s=0;var V=Math.floor((256*o.charCodeAt(s)+o.charCodeAt(s+1)+7)/8);dk=mpi2b(o.substr(s,V+2)),i+="SK-d:"+V+","+dk+"\n",s+=V+2;var D=Math.floor((256*o.charCodeAt(s)+o.charCodeAt(s+1)+7)/8);pk=mpi2b(o.substr(s,D+2)),i+="SK-p:"+D+","+pk+"\n",s+=D+2;var F=Math.floor((256*o.charCodeAt(s)+o.charCodeAt(s+1)+7)/8);qk=mpi2b(o.substr(s,F+2)),i+="SK-q:"+F+","+qk+"\n",s+=F+2;var Y=Math.floor((256*o.charCodeAt(s)+o.charCodeAt(s+1)+7)/8);uk=mpi2b(o.substr(s,Y+2)),i+="SK-u:"+Y+","+uk+"\n",s+=Y+2}else i+="---could not decode encrypted private key---\n";else{var V=Math.floor((256*d.charCodeAt(s)+d.charCodeAt(s+1)+7)/8);dk=mpi2b(d.substr(s,V+2)),i+="SK-d:"+V+","+dk+"\n",s+=V+2;var D=Math.floor((256*d.charCodeAt(s)+d.charCodeAt(s+1)+7)/8);pk=mpi2b(d.substr(s,D+2)),i+="SK-p:"+D+","+pk+"\n",s+=D+2;var F=Math.floor((256*d.charCodeAt(s)+d.charCodeAt(s+1)+7)/8);qk=mpi2b(d.substr(s,F+2)),i+="SK-q:"+F+","+qk+"\n",s+=F+2;var Y=Math.floor((256*d.charCodeAt(s)+d.charCodeAt(s+1)+7)/8);uk=mpi2b(d.substr(s,Y+2)),i+="SK-u:"+Y+","+uk+"\n",s+=Y+2}}else if(6==u){i+=" => Public Key Packet\n";var f=d.charCodeAt(s++),g=(d.charCodeAt(s++)<<24)+(d.charCodeAt(s++)<<16)+(d.charCodeAt(s++)<<8)+d.charCodeAt(s++);if(i+="Version:"+f+" Created:"+g,3==f){var S=d.charCodeAt(s++)<<8+d.charCodeAt(s++);i+=" Valid:"+S}var b=d.charCodeAt(s++);if(i+=" Algorithm:"+b+"\n",b<1||b>3){alert("Algorithm is NOT RSA\n");break}var y=Math.floor((256*d.charCodeAt(s)+d.charCodeAt(s+1)+7)/8),C=mpi2b(d.substr(s,y+2));i+="PK-modulus:"+y+","+C+"\n",s+=y+2;var x=Math.floor((256*d.charCodeAt(s)+d.charCodeAt(s+1)+7)/8),B=mpi2b(d.substr(s,x+2));i+="PK-exp:"+x+","+B+"\n",s+=x+2}else if(7==u)i+=" => Secret-Subkey Packet\n";else if(8==u)i+=" => Compressed Data Packet\n";else{if(9==u){i+=" => Symmetrically Encrypted Data Packet\n",d=GPGdecode(seskey,d.substr(s,a)),i+="---Start of decrypted packets---\n",s=0;continue}if(11==u){i+=" => Literal data Packet\n";var U=d.charAt(s++);i+="LiteralType:"+U+"\n";var X=d.charCodeAt(s++),J=d.substr(s,X);s+=X;var W=(d.charCodeAt(s++)<<24)+(d.charCodeAt(s++)<<16)+(d.charCodeAt(s++)<<8)+d.charCodeAt(s++);i+="File:"+J+"\nDate:"+W+"\n",o=d.substr(s,a-X-6),i+="---Start of literal data---\n"+o+"\n---\n"}else if(12==u)i+=" => Trust Packet\n";else if(13==u)i+=" => User id Packet\n"+d.substr(s,a)+"\n";else if(14==u)i+=" => Public-Subkey Packet\n";else{if(18==u){i+=" => Symmetrically Encrypted Integrity Protected Data Packet\n";var f=d.charCodeAt(s++);if(1!=f){alert("Sym. Enc. Int. Prot. Data Packet not version 1\n");break}d=GPGdecode(seskey,d.substr(s,a-1)),i+="---Start of decrypted packets,length:"+d.length+"---\n",s=0;continue}i+="\n"}}s=l+a}return i}function randomByte(){return 255&Math.round(255*Math.random())}function timeByte(){return(new Date).getTime()>>>2&255}function rnTimer(){for(var r=timeByte(),e=0;e<256;e++)r^=randomByte(),rnArray[255&rnNext++]^=r;stop||setTimeout(rnTimer,128|randomByte())}function randomString(r,e){for(var t="",n=timeByte(),o=0;o<r;)n^=rnArray[255&rnRead++]^mouseByte()^keyByte(),0==n&&e||(o++,t+=String.fromCharCode(n));return t}function hex2s(r){var e="";r.length%2&&(r+="0");for(var t=0;t<r.length;t+=2)e+=String.fromCharCode(parseInt(r.slice(t,t+2),16));return e}function crc24(r){for(var e=11994318,t=0;t<r.length;t++)for(e^=(255&r.charCodeAt(t))<<16,i=0;i<8;i++)e<<=1,16777216&e&&(e^=25578747);return String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)}function GPGencrypt(r,e){var t,n,o=e.length,a=(r.length,new Array(bpbl)),s=new Array(bpbl),i=new Array(bpbl+2),h=new Array,c="";if(o%bpbl)for(t=o%bpbl;t<bpbl;t++)e+="\0";for(h=keyExpansion(r),t=0;t<bpbl;t++)a[t]=0,s[t]=randomByte();for(a=AESencrypt(a,h),t=0;t<bpbl;t++)i[t]=a[t]^=s[t];for(a=AESencrypt(a,h),i[bpbl]=a[0]^s[bpbl-2],i[bpbl+1]=a[1]^s[bpbl-1],t=0;t<bpbl+2;t++)c+=String.fromCharCode(i[t]);for(a=i.slice(2,bpbl+2),n=0;n<e.length;n+=bpbl)for(a=AESencrypt(a,h),t=0;t<bpbl;t++)a[t]^=e.charCodeAt(n+t),c+=String.fromCharCode(a[t]);return c.substr(0,o+bpbl+2)}function GPGpkt(r,e){e>255&&(r+=1);var t=String.fromCharCode(r);return e>255&&(t+=String.fromCharCode(e/256)),t+=String.fromCharCode(e%256)}function GPGpkesk(r,e,t,n,o){var a=new Array,s=new Array,i="",h=r2s(o),c=Math.floor((256*h.charCodeAt(0)+h.charCodeAt(1)+7)/8);if(a=mpi2b(h.substr(0,c+2)),e){var d=new Array,u=new Array,l=new Array,f=new Array,A=Math.floor((256*h.charCodeAt(c+2)+h.charCodeAt(c+3)+7)/8)+2;d=mpi2b(h.substr(c+2,A)),u=mpi2b(h.substr(c+2+A)),s[0]=9,l=bmodexp(d,s,a),f=bmodexp(u,s,a)}else s=mpi2b(h.substr(c+2));for(var b=n.length,m=0,y=0;y<b;y++)m+=n.charCodeAt(y);m&=65535;var C=8*(c-2)+2,p=String.fromCharCode(C/256)+String.fromCharCode(C%256)+String.fromCharCode(2)+randomString(c-b-6,1)+"\0"+String.fromCharCode(t)+n+String.fromCharCode(m/256)+String.fromCharCode(255&m);return e?(i=b2mpi(l)+b2mpi(bmod(bmul(mpi2b(p),f),a)),GPGpkt(132,i.length+10)+String.fromCharCode(3)+r+String.fromCharCode(16)+i):(i=b2mpi(bmodexp(mpi2b(p),s,a)),GPGpkt(132,i.length+10)+String.fromCharCode(3)+r+String.fromCharCode(1)+i)}function GPGld(r){return r.indexOf("\r\n")==-1&&(r=r.replace(/\n/g,"\r\n")),GPGpkt(172,r.length+10)+"t"+String.fromCharCode(4)+"file\0\0\0\0"+r}function GPGsed(r,e){var t=GPGencrypt(r,GPGld(e));return GPGpkt(164,t.length)+t}function doEncrypt(r,e,t,n){var o=7,a=[16,24,32],s=a[o-7],i=randomString(s,0);r=hex2s(r);var h=GPGpkesk(r,e,o,i,t)+GPGsed(i,n);return"-----BEGIN PGP MESSAGE-----\nVersion: haneWIN JavascriptPG v2.0\n\n"+s2r(h)+"\n="+s2r(crc24(h))+"\n-----END PGP MESSAGE-----\n"}function s2hex(r){for(var e="",t=0;t<r.length;t++)c=r.charCodeAt(t),e+=(c<16?"0":"")+c.toString(16);return e}function getPublicKey(r){var e=0,t=r.indexOf("-----BEGIN PGP PUBLIC KEY BLOCK-----");if(t==-1)return alert("No PGP Public Key Block"),this.vers="",this.fp="",this.keyid="",this.user="",void(this.pkey="");var n=r.indexOf("\n\n",t);n>0?n+=2:(n=r.indexOf("\n\r\n",t),n>0&&(n+=3));var o=r.indexOf("\n=",t);if(!(n>0&&o>0))return alert("Invalid PGP Public Key Block"),this.vers="",this.fp="",this.keyid="",this.user="",void(this.pkey="");r=r.slice(n,o);for(var a=r2s(r),t=0;t<a.length;){var s=a.charCodeAt(t++);if(0==(128&s))break;if(64&s?(s&=63,len=a.charCodeAt(t++),len>191&&len<224?len=(len-192<<8)+a.charCodeAt(t++):255==len?len=(a.charCodeAt(t++)<<24)+(a.charCodeAt(t++)<<16)+(a.charCodeAt(t++)<<8)+a.charCodeAt(t++):len>223&&len<255&&(len=1<<(31&len))):(len=3&s,s=s>>2&15,0==len?len=a.charCodeAt(t++):1==len?len=(a.charCodeAt(t++)<<8)+a.charCodeAt(t++):2==len?len=(a.charCodeAt(t++)<<24)+(a.charCodeAt(t++)<<16)+(a.charCodeAt(t++)<<8)+a.charCodeAt(t++):len=a.length-1),6==s||14==s){var i=t,h=a.charCodeAt(t++);e=1,this.vers=h;(a.charCodeAt(t++)<<24)+(a.charCodeAt(t++)<<16)+(a.charCodeAt(t++)<<8)+a.charCodeAt(t++);if(2==h||3==h){a.charCodeAt(t++)<<8+a.charCodeAt(t++)}var c=a.charCodeAt(t++);if(1==c||2==c){var d=t,u=Math.floor((256*a.charCodeAt(t)+a.charCodeAt(t+1)+7)/8);t+=u+2;var l=a.substr(d,u+2),f=Math.floor((256*a.charCodeAt(t)+a.charCodeAt(t+1)+7)/8);if(t+=f+2,this.pkey=s2r(a.substr(d,u+f+4)),this.type="RSA",3==h)this.fp="",this.keyid=s2hex(l.substr(l.length-8,8));else if(4==h){var A=String.fromCharCode(153)+String.fromCharCode(len>>8)+String.fromCharCode(255&len)+a.substr(i,len),b=str_sha1(A);this.fp=s2hex(b),this.keyid=s2hex(b.substr(b.length-8,8))}else this.fp="",this.keyid="";e=2}else if(16!=c&&20!=c||4!=h)t=i+len;else{var d=t,m=Math.floor((256*a.charCodeAt(t)+a.charCodeAt(t+1)+7)/8);t+=m+2;var y=Math.floor((256*a.charCodeAt(t)+a.charCodeAt(t+1)+7)/8);t+=y+2;var C=Math.floor((256*a.charCodeAt(t)+a.charCodeAt(t+1)+7)/8);t+=C+2,this.pkey=s2r(a.substr(d,m+y+C+6));var A=String.fromCharCode(153)+String.fromCharCode(len>>8)+String.fromCharCode(255&len)+a.substr(i,len),b=str_sha1(A);this.fp=s2hex(b),this.keyid=s2hex(b.substr(b.length-8,8)),this.type="ELGAMAL",e=3}}else 13==s?(this.user=a.substr(t,len),t+=len):t+=len}e<2&&(this.vers="",this.fp="",this.keyid="",0==e?this.user="No public key packet found.":1==e&&(this.user="public key algorithm is "+c+" not RSA or ELGAMAL."),this.pkey="")}function B0(r){return 255&r}function B1(r){return r>>8&255}function B2(r){return r>>16&255}function B3(r){return r>>24&255}function F1(r,e,t,n){return B1(T1[255&r])|B1(T1[e>>8&255])<<8|B1(T1[t>>16&255])<<16|B1(T1[n>>>24])<<24}function packBytes(r){var e,t,n=r.length,o=new Array(n/4);if(r&&!(n%4)){for(e=0,t=0;t<n;t+=4)o[e++]=r[t]|r[t+1]<<8|r[t+2]<<16|r[t+3]<<24;return o}}function unpackBytes(r){var e,t=0,n=r.length,o=new Array(4*n);for(e=0;e<n;e++)o[t++]=B0(r[e]),o[t++]=B1(r[e]),o[t++]=B2(r[e]),o[t++]=B3(r[e]);return o}function keyExpansion(r){var e,t,n,o,a,s,i=new Array(maxrk+1),h=r.length,c=new Array(maxkc),d=new Array(maxkc),u=0;if(16==h)s=10,e=4;else if(24==h)s=12,e=6;else{if(32!=h)return void alert("Invalid AES key length "+h);s=14,e=8}for(t=0;t<maxrk+1;t++)i[t]=new Array(4);for(t=0,n=0;n<h;n++,t+=4)c[n]=r.charCodeAt(t)|r.charCodeAt(t+1)<<8|r.charCodeAt(t+2)<<16|r.charCodeAt(t+3)<<24;for(n=e-1;n>=0;n--)d[n]=c[n];for(o=0,a=0,n=0;n<e&&o<s+1;){for(;n<e&&a<4;n++,a++)i[o][a]=d[n];4==a&&(o++,a=0)}for(;o<s+1;){var l=d[e-1];if(d[0]^=S[B1(l)]|S[B2(l)]<<8|S[B3(l)]<<16|S[B0(l)]<<24,d[0]^=Rcon[u++],8!=e)for(n=1;n<e;n++)d[n]^=d[n-1];else{for(n=1;n<e/2;n++)d[n]^=d[n-1];for(l=d[e/2-1],d[e/2]^=S[B0(l)]|S[B1(l)]<<8|S[B2(l)]<<16|S[B3(l)]<<24,n=e/2+1;n<e;n++)d[n]^=d[n-1]}for(n=0;n<e&&o<s+1;){for(;n<e&&a<4;n++,a++)i[o][a]=d[n];4==a&&(o++,a=0)}}return this.rounds=s,this.rk=i,this}function AESencrypt(r,e){var t,n,o,a,s,i=packBytes(r),h=e.rounds,c=i[0],d=i[1],u=i[2],l=i[3];for(t=0;t<h-1;t++)n=c^e.rk[t][0],o=d^e.rk[t][1],a=u^e.rk[t][2],s=l^e.rk[t][3],c=T1[255&n]^T2[o>>8&255]^T3[a>>16&255]^T4[s>>>24],d=T1[255&o]^T2[a>>8&255]^T3[s>>16&255]^T4[n>>>24],u=T1[255&a]^T2[s>>8&255]^T3[n>>16&255]^T4[o>>>24],l=T1[255&s]^T2[n>>8&255]^T3[o>>16&255]^T4[a>>>24];return t=h-1,n=c^e.rk[t][0],o=d^e.rk[t][1],a=u^e.rk[t][2],s=l^e.rk[t][3],i[0]=F1(n,o,a,s)^e.rk[h][0],i[1]=F1(o,a,s,n)^e.rk[h][1],i[2]=F1(a,s,n,o)^e.rk[h][2],i[3]=F1(s,n,o,a)^e.rk[h][3],unpackBytes(i)}function s2r(r){var e,t,n,o="",a=0,s=0,i=r.length;for(n=0;n<i;n++)t=r.charCodeAt(n),0==s?(o+=b64s.charAt(t>>2&63),e=(3&t)<<4):1==s?(o+=b64s.charAt(e|t>>4&15),e=(15&t)<<2):2==s&&(o+=b64s.charAt(e|t>>6&3),a+=1,a%60==0&&(o+="\n"),o+=b64s.charAt(63&t)),a+=1,a%60==0&&(o+="\n"),s+=1,3==s&&(s=0);return s>0&&(o+=b64s.charAt(e),a+=1,a%60==0&&(o+="\n"),o+="=",a+=1),1==s&&(a%60==0&&(o+="\n"),o+="="),o}function r2s(r){var e,t,n="",o=0,a=0,s=r.length;for(t=0;t<s;t++)e=b64s.indexOf(r.charAt(t)),e>=0&&(o&&(n+=String.fromCharCode(a|e>>6-o&255)),o=o+2&7,a=e<<o&255);return n}function cast5(r){return this.masking=new Array(16),this.rotate=new Array(16),this.Reset(),r.length!=KeySize?(alert("CAST-128: keys must be 16 bytes"),!1):(this.keySchedule(r),!0)}function f1(r,e,t){var n=e+r,o=n<<t|n>>>32-t;return(sBox[0][o>>>24]^sBox[1][o>>>16&255])-sBox[2][o>>>8&255]+sBox[3][255&o]}function f2(r,e,t){var n=e^r,o=n<<t|n>>>32-t;return sBox[0][o>>>24]-sBox[1][o>>>16&255]+sBox[2][o>>>8&255]^sBox[3][255&o]}function f3(r,e,t){var n=e-r,o=n<<t|n>>>32-t;return(sBox[0][o>>>24]+sBox[1][o>>>16&255]^sBox[2][o>>>8&255])-sBox[3][255&o]}function rc4Init(){var r,e,t=new Array(256);for(r=0;r<256;r++)s[r]=r,t[r]=randomByte()^timeByte();for(y=0,r=0;r<2;r++)for(x=0;x<256;x++)y=(t[r]+s[x]+y)%256,e=s[x],s[x]=s[y],s[y]=e;x=0,y=0}function rc4Next(r){var e;return x=x+1&255,y=s[x]+y&255,e=s[x],s[x]=s[y],s[y]=e,255&(r^s[(s[x]+s[y])%256])}function keyByte(){return keyArray[keyRead++%keyNext]}function keyPressEntropy(r){keyArray[keyNext++%256]^=timeByte()}function mouseByte(){return mouseArray[mouseRead++%mouseNext]}function mouseMoveEntropy(r){var e;r||(r=window.event),mouseMoveSkip--<=0&&(e=oldMoveHandler?r.clientX<<4|15&r.clientY:r.screenX<<4|15&r.screenY,mouseArray[mouseNext++%256]^=rc4Next(255&e),mouseArray[mouseNext++%256]^=rc4Next(timeByte()),mouseMoveSkip=7&randomByte())}function eventsEnd(){document.removeEventListener?(document.removeEventListener("mousemove",mouseMoveEntropy,!1),document.removeEventListener("keypress",keyPressEntropy,!1)):document.detachEvent?(document.detachEvent("onmousemove",mouseMoveEntropy),document.detachEvent("onkeypress",keyPressEntropy)):document.releaseEvents?(document.releaseEvents(EVENT.MOUSEMOVE),document.onMousemove=0,document.releaseEvents(EVENT.KEYPRESS),document.onKeypress=0):(document.onMousemove=oldMoveHandler,document.onKeypress=oldKeyHandler)}function eventsCollect(){document.implementation.hasFeature("Events","2.0")&&document.addEventListener?(document.addEventListener("mousemove",mouseMoveEntropy,!1),document.addEventListener("keypress",keyPressEntropy,!1)):document.attachEvent?(document.attachEvent("onmousemove",mouseMoveEntropy),document.attachEvent("onkeypress",keyPressEntropy)):document.captureEvents?(document.captureEvents(Event.MOUSEMOVE),document.onMousemove=mouseMoveEntropy,document.captureEvents(Event.KEYPRESS),document.onMousemove=keyPressEntropy):(oldMoveHandler=document.onmousemove,document.onMousemove=mouseMoveEntropy,oldKeyHandler=document.onkeypress,document.onKeypress=keyPressEntropy),rc4Init()}function zeros(r){for(var e=new Array(r);r-- >0;)e[r]=0;return e}function zclip(r){var e=r.length;if(r[e-1])return r;for(;e>1&&0==r[e-1];)e--;return r.slice(0,e)}function nbits(r){var e,t=1;return 0!=(e=r>>>16)&&(r=e,t+=16),0!=(e=r>>8)&&(r=e,t+=8),0!=(e=r>>4)&&(r=e,t+=4),0!=(e=r>>2)&&(r=e,t+=2),0!=(e=r>>1)&&(r=e,t+=1),t}function badd(r,e){var t=r.length,n=e.length;if(t<n)return badd(e,r);for(var o=new Array(t),a=0,s=0;s<n;s++)a+=r[s]+e[s],o[s]=a&bm,a>>>=bs;for(;s<t;s++)a+=r[s],o[s]=a&bm,a>>>=bs;return a&&(o[s]=a),o}function bsub(r,e){var t=r.length,n=e.length;if(n>t)return[];if(n==t){if(e[n-1]>r[n-1])return[];if(1==n)return[r[0]-e[0]]}for(var o=new Array(t),a=0,s=0;s<n;s++)a+=r[s]-e[s],o[s]=a&bm,a>>=bs;for(;s<t;s++)a+=r[s],o[s]=a&bm,a>>=bs;return a?[]:zclip(o)}function ip(r,e,t,n,o){var a=t&bdm,s=t>>bd,i=n&bdm,h=n>>bd,c=s*i+h*a,d=a*i+((c&bdm)<<bd)+r[e]+o;return r[e]=d&bm,o=s*h+(c>>bd)+(d>>bs)}function bsqr(r){var e,t,n=r.length,o=2*n,a=zeros(o),s=0;for(e=0;e<n;e++){for(s=ip(a,2*e,r[e],r[e],0),t=e+1;t<n;t++)s=ip(a,e+t,2*r[t],r[e],s);a[e+n]=s}return zclip(a)}function bmul(r,e){var t,n,o,a=r.length,s=e.length,i=zeros(a+s-1);for(n=0;n<s;n++){for(t=0,o=0;o<a;o++)t=ip(i,n+o,r[o],e[n],t);i[n+a]=t}return zclip(i)}function toppart(r,e,t){for(var n=0;e>=0&&t-- >0;)n=n*bx2+r[e--];return n}function bdiv(r,e){var t=r.length-1,n=e.length-1,o=t-n;if(t<n||t==n&&(r[t]<e[t]||t>0&&r[t]==e[t]&&r[t-1]<e[t-1]))return this.q=[0],this.mod=r,this;if(t==n&&toppart(r,n,2)/toppart(e,n,2)<4){for(var a,s=r.concat(),i=0;a=bsub(s,e),0!=a.length;)s=a,i++;return this.q=[i],this.mod=s,this}var h=Math.floor(Math.log(e[n])/log2)+1,c=bs-h,s=r.concat(),d=e.concat();if(c){for(u=n;u>0;u--)d[u]=d[u]<<c&bm|d[u-1]>>h;for(d[0]=d[0]<<c&bm,s[t]&(bm<<h&bm)&&(s[++t]=0,o++),u=t;u>0;u--)s[u]=s[u]<<c&bm|s[u-1]>>h;s[0]=s[0]<<c&bm}for(var u,l,f=zeros(o+1),A=zeros(o).concat(d);l=bsub(s,A),0!=l.length;)f[o]++,s=l;var b=d[n],m=toppart(d,n,2);for(u=t;u>n;u--){var y=u-n-1;u>=s.length?f[y]=1:s[u]==b?f[y]=bm:f[y]=Math.floor(toppart(s,u,2)/b);for(var C=toppart(s,u,3);f[y]*m>C;)f[y]--;A=A.slice(1),l=bsub(s,bmul([f[y]],A)),0==l.length&&(f[y]--,l=bsub(s,bmul([f[y]],A))),s=l}if(c){for(u=0;u<s.length-1;u++)s[u]=s[u]>>c|s[u+1]<<h&bm;s[s.length-1]>>=c}return this.q=zclip(f),this.mod=zclip(s),this}function simplemod(r,e){for(var t,n=0,o=r.length-1;o>=0;o--)t=r[o],n=((t>>bd)+(n<<bd))%e,n=((t&bdm)+(n<<bd))%e;return n}function bmod(r,e){if(1==e.length){if(1==r.length)return[r[0]%e[0]];if(e[0]<bdm)return[simplemod(r,e[0])]}var t=bdiv(r,e);return t.mod}function bmod2(r,e,t){var n=r.length-(e.length<<1);if(n>0)return bmod2(r.slice(0,n).concat(bmod2(r.slice(n),e,t)),e,t);var o,a=e.length+1,s=e.length-1,i=bmul(r.slice(s),t).slice(a),h=r.slice(0,a),c=bmul(i,e).slice(0,a),d=bsub(h,c);0==d.length&&(h[a]=1,d=bsub(h,c));for(var u=0;o=bsub(d,e),0!=o.length;u++)if(d=o,u>=3)return bmod2(d,e,t);return d}function bexpmod(r,e,t){for(var n=r.concat(),o=e.length-1,a=nbits(e[o])-2;o>=0;o--){for(;a>=0;a-=1)n=bmod(bsqr(n),t),e[o]&1<<a&&(n=bmod(bmul(n,r),t));a=bs-1}return n}function bmodexp(r,e,t){var n=r.concat(),o=e.length-1,a=2*t.length,s=zeros(a+1);for(s[a]=1,s=bdiv(s,t).q,a=nbits(e[o])-2;o>=0;o--){for(;a>=0;a-=1)n=bmod2(bsqr(n),t,s),e[o]&1<<a&&(n=bmod2(bmul(n,r),t,s));a=bs-1}return n}function RSAencrypt(r,e,t){return bexpmod(r,e,t)}function RSAdecrypt(r,e,t,n,o){var a=bmodexp(bmod(r,t),bmod(e,bsub(t,[1])),t),s=bmodexp(bmod(r,n),bmod(e,bsub(n,[1])),n),i=bsub(s,a);return 0==i.length?(i=bsub(a,s),i=bmod(bmul(i,o),n),i=bsub(n,i)):i=bmod(bmul(i,o),n),badd(bmul(i,t),a)}function mpi2b(r){var e,t=1,n=[0],o=0,a=256,s=r.length;if(s<2)return alert("string too short, not a MPI"),0;var i=8*(s-2),h=256*r.charCodeAt(0)+r.charCodeAt(1);if(h>i||h<i-8)return alert("not a MPI, bits="+h+",len="+i),0;for(var c=0;c<i;c++)(a<<=1)>255&&(a=1,e=r.charCodeAt(--s)),t>bm&&(t=1,n[++o]=0),e&a&&(n[o]|=t),t<<=1;return n}function b2mpi(r){var e,t=1,n=0,o=[0],a=1,s=0,i=r.length*bs,h="";for(e=0;e<i;e++)r[n]&t&&(o[s]|=a),(a<<=1)>255&&(a=1,o[++s]=0),(t<<=1)>bm&&(t=1,n++);for(;s&&0==o[s];)s--;for(t=256,i=8;i>0&&!(o[s]&(t>>=1));i--);if(i+=8*s,h+=String.fromCharCode(i/256)+String.fromCharCode(i%256),i)for(e=s;e>=0;e--)h+=String.fromCharCode(o[e]);return h}function hex_sha1(r){return binb2hex(core_sha1(str2binb(r),r.length*chrsz))}function b64_sha1(r){return binb2b64(core_sha1(str2binb(r),r.length*chrsz))}function str_sha1(r){return binb2str(core_sha1(str2binb(r),r.length*chrsz))}function hex_hmac_sha1(r,e){return binb2hex(core_hmac_sha1(r,e))}function b64_hmac_sha1(r,e){return binb2b64(core_hmac_sha1(r,e))}function str_hmac_sha1(r,e){return binb2str(core_hmac_sha1(r,e))}function sha1_vm_test(){return"a9993e364706816aba3e25717850c26c9cd0d89d"==hex_sha1("abc")}function core_sha1(r,e){r[e>>5]|=128<<24-e%32,r[(e+64>>9<<4)+15]=e;for(var t=Array(80),n=1732584193,o=-271733879,a=-1732584194,s=271733878,i=-1009589776,h=0;h<r.length;h+=16){for(var c=n,d=o,u=a,l=s,f=i,A=0;A<80;A++){A<16?t[A]=r[h+A]:t[A]=rol(t[A-3]^t[A-8]^t[A-14]^t[A-16],1);var b=safe_add(safe_add(rol(n,5),sha1_ft(A,o,a,s)),safe_add(safe_add(i,t[A]),sha1_kt(A)));i=s,s=a,a=rol(o,30),o=n,n=b}n=safe_add(n,c),o=safe_add(o,d),a=safe_add(a,u),s=safe_add(s,l),i=safe_add(i,f)}return Array(n,o,a,s,i)}function sha1_ft(r,e,t,n){return r<20?e&t|~e&n:r<40?e^t^n:r<60?e&t|e&n|t&n:e^t^n}function sha1_kt(r){return r<20?1518500249:r<40?1859775393:r<60?-1894007588:-899497514}function core_hmac_sha1(r,e){var t=str2binb(r);t.length>16&&(t=core_sha1(t,r.length*chrsz));for(var n=Array(16),o=Array(16),a=0;a<16;a++)n[a]=909522486^t[a],o[a]=1549556828^t[a];var s=core_sha1(n.concat(str2binb(e)),512+e.length*chrsz);return core_sha1(o.concat(s),672)}function safe_add(r,e){var t=(65535&r)+(65535&e),n=(r>>16)+(e>>16)+(t>>16);return n<<16|65535&t}function rol(r,e){return r<<e|r>>>32-e}function str2binb(r){for(var e=Array(),t=(1<<chrsz)-1,n=0;n<r.length*chrsz;n+=chrsz)e[n>>5]|=(r.charCodeAt(n/chrsz)&t)<<24-n%32;return e}function binb2str(r){for(var e="",t=(1<<chrsz)-1,n=0;n<32*r.length;n+=chrsz)e+=String.fromCharCode(r[n>>5]>>>24-n%32&t);return e}function binb2hex(r){for(var e=hexcase?"0123456789ABCDEF":"0123456789abcdef",t="",n=0;n<4*r.length;n++)t+=e.charAt(r[n>>2]>>8*(3-n%4)+4&15)+e.charAt(r[n>>2]>>8*(3-n%4)&15);return t}function binb2b64(r){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t="",n=0;n<4*r.length;n+=3)for(var o=(r[n>>2]>>8*(3-n%4)&255)<<16|(r[n+1>>2]>>8*(3-(n+1)%4)&255)<<8|r[n+2>>2]>>8*(3-(n+2)%4)&255,a=0;a<4;a++)t+=8*n+6*a>32*r.length?b64pad:e.charAt(o>>6*(3-a)&63);return t}var bpbl=16,rnArray=new Array(256),rnNext=0,rnRead=0;rnTimer();var bpbl=16;module.exports.encrypt=function(r,e){return doEncrypt(r.id,r.type,r.key,e)};var stop=!1;module.exports.stop=function(){stop=!0},module.exports.extract=function(r){var e=new getPublicKey(r);return{version:e.vers,user:e.user,id:e.keyid,type:"RSA"==e.type?0:1,key:e.pkey.replace(/\n/g,"")}};var Rcon=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],S=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],T1=[2774754246,2222750968,2574743534,2373680118,234025727,3177933782,2976870366,1422247313,1345335392,50397442,2842126286,2099981142,436141799,1658312629,3870010189,2591454956,1170918031,2642575903,1086966153,2273148410,368769775,3948501426,3376891790,200339707,3970805057,1742001331,4255294047,3937382213,3214711843,4154762323,2524082916,1539358875,3266819957,486407649,2928907069,1780885068,1513502316,1094664062,49805301,1338821763,1546925160,4104496465,887481809,150073849,2473685474,1943591083,1395732834,1058346282,201589768,1388824469,1696801606,1589887901,672667696,2711000631,251987210,3046808111,151455502,907153956,2608889883,1038279391,652995533,1764173646,3451040383,2675275242,453576978,2659418909,1949051992,773462580,756751158,2993581788,3998898868,4221608027,4132590244,1295727478,1641469623,3467883389,2066295122,1055122397,1898917726,2542044179,4115878822,1758581177,0,753790401,1612718144,536673507,3367088505,3982187446,3194645204,1187761037,3653156455,1262041458,3729410708,3561770136,3898103984,1255133061,1808847035,720367557,3853167183,385612781,3309519750,3612167578,1429418854,2491778321,3477423498,284817897,100794884,2172616702,4031795360,1144798328,3131023141,3819481163,4082192802,4272137053,3225436288,2324664069,2912064063,3164445985,1211644016,83228145,3753688163,3249976951,1977277103,1663115586,806359072,452984805,250868733,1842533055,1288555905,336333848,890442534,804056259,3781124030,2727843637,3427026056,957814574,1472513171,4071073621,2189328124,1195195770,2892260552,3881655738,723065138,2507371494,2690670784,2558624025,3511635870,2145180835,1713513028,2116692564,2878378043,2206763019,3393603212,703524551,3552098411,1007948840,2044649127,3797835452,487262998,1994120109,1004593371,1446130276,1312438900,503974420,3679013266,168166924,1814307912,3831258296,1573044895,1859376061,4021070915,2791465668,2828112185,2761266481,937747667,2339994098,854058965,1137232011,1496790894,3077402074,2358086913,1691735473,3528347292,3769215305,3027004632,4199962284,133494003,636152527,2942657994,2390391540,3920539207,403179536,3585784431,2289596656,1864705354,1915629148,605822008,4054230615,3350508659,1371981463,602466507,2094914977,2624877800,555687742,3712699286,3703422305,2257292045,2240449039,2423288032,1111375484,3300242801,2858837708,3628615824,84083462,32962295,302911004,2741068226,1597322602,4183250862,3501832553,2441512471,1489093017,656219450,3114180135,954327513,335083755,3013122091,856756514,3144247762,1893325225,2307821063,2811532339,3063651117,572399164,2458355477,552200649,1238290055,4283782570,2015897680,2061492133,2408352771,4171342169,2156497161,386731290,3669999461,837215959,3326231172,3093850320,3275833730,2962856233,1999449434,286199582,3417354363,4233385128,3602627437,974525996],T2=[1667483301,2088564868,2004348569,2071721613,4076011277,1802229437,1869602481,3318059348,808476752,16843267,1734856361,724260477,4278118169,3621238114,2880130534,1987505306,3402272581,2189565853,3385428288,2105408135,4210749205,1499050731,1195871945,4042324747,2913812972,3570709351,2728550397,2947499498,2627478463,2762232823,1920132246,3233848155,3082253762,4261273884,2475900334,640044138,909536346,1061125697,4160222466,3435955023,875849820,2779075060,3857043764,4059166984,1903288979,3638078323,825320019,353708607,67373068,3351745874,589514341,3284376926,404238376,2526427041,84216335,2593796021,117902857,303178806,2155879323,3806519101,3958099238,656887401,2998042573,1970662047,151589403,2206408094,741103732,437924910,454768173,1852759218,1515893998,2694863867,1381147894,993752653,3604395873,3014884814,690573947,3823361342,791633521,2223248279,1397991157,3520182632,0,3991781676,538984544,4244431647,2981198280,1532737261,1785386174,3419114822,3200149465,960066123,1246401758,1280088276,1482207464,3486483786,3503340395,4025468202,2863288293,4227591446,1128498885,1296931543,859006549,2240090516,1162185423,4193904912,33686534,2139094657,1347461360,1010595908,2678007226,2829601763,1364304627,2745392638,1077969088,2408514954,2459058093,2644320700,943222856,4126535940,3166462943,3065411521,3671764853,555827811,269492272,4294960410,4092853518,3537026925,3452797260,202119188,320022069,3974939439,1600110305,2543269282,1145342156,387395129,3301217111,2812761586,2122251394,1027439175,1684326572,1566423783,421081643,1936975509,1616953504,2172721560,1330618065,3705447295,572671078,707417214,2425371563,2290617219,1179028682,4008625961,3099093971,336865340,3739133817,1583267042,185275933,3688607094,3772832571,842163286,976909390,168432670,1229558491,101059594,606357612,1549580516,3267534685,3553869166,2896970735,1650640038,2442213800,2509582756,3840201527,2038035083,3890730290,3368586051,926379609,1835915959,2374828428,3587551588,1313774802,2846444e3,1819072692,1448520954,4109693703,3941256997,1701169839,2054878350,2930657257,134746136,3132780501,2021191816,623200879,774790258,471611428,2795919345,3031724999,3334903633,3907570467,3722289532,1953818780,522141217,1263245021,3183305180,2341145990,2324303749,1886445712,1044282434,3048567236,1718013098,1212715224,50529797,4143380225,235805714,1633796771,892693087,1465364217,3115936208,2256934801,3250690392,488454695,2661164985,3789674808,4177062675,2560109491,286335539,1768542907,3654920560,2391672713,2492740519,2610638262,505297954,2273777042,3924412704,3469641545,1431677695,673730680,3755976058,2357986191,2711706104,2307459456,218962455,3216991706,3873888049,1111655622,1751699640,1094812355,2576951728,757946999,252648977,2964356043,1414834428,3149622742,370551866],T3=[1673962851,2096661628,2012125559,2079755643,4076801522,1809235307,1876865391,3314635973,811618352,16909057,1741597031,727088427,4276558334,3618988759,2874009259,1995217526,3398387146,2183110018,3381215433,2113570685,4209972730,1504897881,1200539975,4042984432,2906778797,3568527316,2724199842,2940594863,2619588508,2756966308,1927583346,3231407040,3077948087,4259388669,2470293139,642542118,913070646,1065238847,4160029431,3431157708,879254580,2773611685,3855693029,4059629809,1910674289,3635114968,828527409,355090197,67636228,3348452039,591815971,3281870531,405809176,2520228246,84545285,2586817946,118360327,304363026,2149292928,3806281186,3956090603,659450151,2994720178,1978310517,152181513,2199756419,743994412,439627290,456535323,1859957358,1521806938,2690382752,1386542674,997608763,3602342358,3011366579,693271337,3822927587,794718511,2215876484,1403450707,3518589137,0,3988860141,541089824,4242743292,2977548465,1538714971,1792327274,3415033547,3194476990,963791673,1251270218,1285084236,1487988824,3481619151,3501943760,4022676207,2857362858,4226619131,1132905795,1301993293,862344499,2232521861,1166724933,4192801017,33818114,2147385727,1352724560,1014514748,2670049951,2823545768,1369633617,2740846243,1082179648,2399505039,2453646738,2636233885,946882616,4126213365,3160661948,3061301686,3668932058,557998881,270544912,4293204735,4093447923,3535760850,3447803085,202904588,321271059,3972214764,1606345055,2536874647,1149815876,388905239,3297990596,2807427751,2130477694,1031423805,1690872932,1572530013,422718233,1944491379,1623236704,2165938305,1335808335,3701702620,574907938,710180394,2419829648,2282455944,1183631942,4006029806,3094074296,338181140,3735517662,1589437022,185998603,3685578459,3772464096,845436466,980700730,169090570,1234361161,101452294,608726052,1555620956,3265224130,3552407251,2890133420,1657054818,2436475025,2503058581,3839047652,2045938553,3889509095,3364570056,929978679,1843050349,2365688973,3585172693,1318900302,2840191145,1826141292,1454176854,4109567988,3939444202,1707781989,2062847610,2923948462,135272456,3127891386,2029029496,625635109,777810478,473441308,2790781350,3027486644,3331805638,3905627112,3718347997,1961401460,524165407,1268178251,3177307325,2332919435,2316273034,1893765232,1048330814,3044132021,1724688998,1217452104,50726147,4143383030,236720654,1640145761,896163637,1471084887,3110719673,2249691526,3248052417,490350365,2653403550,3789109473,4176155640,2553000856,287453969,1775418217,3651760345,2382858638,2486413204,2603464347,507257374,2266337927,3922272489,3464972750,1437269845,676362280,3752164063,2349043596,2707028129,2299101321,219813645,3211123391,3872862694,1115997762,1758509160,1099088705,2569646233,760903469,253628687,2960903088,1420360788,3144537787,371997206],T4=[3332727651,4169432188,4003034999,4136467323,4279104242,3602738027,3736170351,2438251973,1615867952,33751297,3467208551,1451043627,3877240574,3043153879,1306962859,3969545846,2403715786,530416258,2302724553,4203183485,4011195130,3001768281,2395555655,4211863792,1106029997,3009926356,1610457762,1173008303,599760028,1408738468,3835064946,2606481600,1975695287,3776773629,1034851219,1282024998,1817851446,2118205247,4110612471,2203045068,1750873140,1374987685,3509904869,4178113009,3801313649,2876496088,1649619249,708777237,135005188,2505230279,1181033251,2640233411,807933976,933336726,168756485,800430746,235472647,607523346,463175808,3745374946,3441880043,1315514151,2144187058,3936318837,303761673,496927619,1484008492,875436570,908925723,3702681198,3035519578,1543217312,2767606354,1984772923,3076642518,2110698419,1383803177,3711886307,1584475951,328696964,2801095507,3110654417,0,3240947181,1080041504,3810524412,2043195825,3069008731,3569248874,2370227147,1742323390,1917532473,2497595978,2564049996,2968016984,2236272591,3144405200,3307925487,1340451498,3977706491,2261074755,2597801293,1716859699,294946181,2328839493,3910203897,67502594,4269899647,2700103760,2017737788,632987551,1273211048,2733855057,1576969123,2160083008,92966799,1068339858,566009245,1883781176,4043634165,1675607228,2009183926,2943736538,1113792801,540020752,3843751935,4245615603,3211645650,2169294285,403966988,641012499,3274697964,3202441055,899848087,2295088196,775493399,2472002756,1441965991,4236410494,2051489085,3366741092,3135724893,841685273,3868554099,3231735904,429425025,2664517455,2743065820,1147544098,1417554474,1001099408,193169544,2362066502,3341414126,1809037496,675025940,2809781982,3168951902,371002123,2910247899,3678134496,1683370546,1951283770,337512970,2463844681,201983494,1215046692,3101973596,2673722050,3178157011,1139780780,3299238498,967348625,832869781,3543655652,4069226873,3576883175,2336475336,1851340599,3669454189,25988493,2976175573,2631028302,1239460265,3635702892,2902087254,4077384948,3475368682,3400492389,4102978170,1206496942,270010376,1876277946,4035475576,1248797989,1550986798,941890588,1475454630,1942467764,2538718918,3408128232,2709315037,3902567540,1042358047,2531085131,1641856445,226921355,260409994,3767562352,2084716094,1908716981,3433719398,2430093384,100991747,4144101110,470945294,3265487201,1784624437,2935576407,1775286713,395413126,2572730817,975641885,666476190,3644383713,3943954680,733190296,573772049,3535497577,2842745305,126455438,866620564,766942107,1008868894,361924487,3374377449,2269761230,2868860245,1350051880,2776293343,59739276,1509466529,159418761,437718285,1708834751,3610371814,2227585602,3501746280,2193834305,699439513,1517759789,504434447,2076946608,2835108948,1842789307,742004246],maxkc=8,maxrk=14,b64s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
const BlockSize=8,KeySize=16;cast5.prototype.Reset=function(){for(var r=0;r<16;r++)this.masking[r]=0,this.rotate[r]=0},cast5.prototype.BlockSize=function(){return BlockSize},cast5.prototype.Encrypt=function(r){var e=new Array(r.length);for(i=0;i<r.length;i+=8){var t,n=r[i]<<24|r[i+1]<<16|r[i+2]<<8|r[i+3],o=r[i+4]<<24|r[i+5]<<16|r[i+6]<<8|r[i+7];t=o,o=n^f1(o,this.masking[0],this.rotate[0]),n=t,t=o,o=n^f2(o,this.masking[1],this.rotate[1]),n=t,t=o,o=n^f3(o,this.masking[2],this.rotate[2]),n=t,t=o,o=n^f1(o,this.masking[3],this.rotate[3]),n=t,t=o,o=n^f2(o,this.masking[4],this.rotate[4]),n=t,t=o,o=n^f3(o,this.masking[5],this.rotate[5]),n=t,t=o,o=n^f1(o,this.masking[6],this.rotate[6]),n=t,t=o,o=n^f2(o,this.masking[7],this.rotate[7]),n=t,t=o,o=n^f3(o,this.masking[8],this.rotate[8]),n=t,t=o,o=n^f1(o,this.masking[9],this.rotate[9]),n=t,t=o,o=n^f2(o,this.masking[10],this.rotate[10]),n=t,t=o,o=n^f3(o,this.masking[11],this.rotate[11]),n=t,t=o,o=n^f1(o,this.masking[12],this.rotate[12]),n=t,t=o,o=n^f2(o,this.masking[13],this.rotate[13]),n=t,t=o,o=n^f3(o,this.masking[14],this.rotate[14]),n=t,t=o,o=n^f1(o,this.masking[15],this.rotate[15]),n=t,e[i]=o>>>24&255,e[i+1]=o>>>16&255,e[i+2]=o>>>8&255,e[i+3]=255&o,e[i+4]=n>>>24&255,e[i+5]=n>>>16&255,e[i+6]=n>>>8&255,e[i+7]=255&n}return e},cast5.prototype.Decrypt=function(r){var e=new Array(r.length);for(i=0;i<r.length;i+=8){var t,n=r[i]<<24|r[i+1]<<16|r[i+2]<<8|r[i+3],o=r[i+4]<<24|r[i+5]<<16|r[i+6]<<8|r[i+7];t=o,o=n^f1(o,this.masking[15],this.rotate[15]),n=t,t=o,o=n^f3(o,this.masking[14],this.rotate[14]),n=t,t=o,o=n^f2(o,this.masking[13],this.rotate[13]),n=t,t=o,o=n^f1(o,this.masking[12],this.rotate[12]),n=t,t=o,o=n^f3(o,this.masking[11],this.rotate[11]),n=t,t=o,o=n^f2(o,this.masking[10],this.rotate[10]),n=t,t=o,o=n^f1(o,this.masking[9],this.rotate[9]),n=t,t=o,o=n^f3(o,this.masking[8],this.rotate[8]),n=t,t=o,o=n^f2(o,this.masking[7],this.rotate[7]),n=t,t=o,o=n^f1(o,this.masking[6],this.rotate[6]),n=t,t=o,o=n^f3(o,this.masking[5],this.rotate[5]),n=t,t=o,o=n^f2(o,this.masking[4],this.rotate[4]),n=t,t=o,o=n^f1(o,this.masking[3],this.rotate[3]),n=t,t=o,o=n^f3(o,this.masking[2],this.rotate[2]),n=t,t=o,o=n^f2(o,this.masking[1],this.rotate[1]),n=t,t=o,o=n^f1(o,this.masking[0],this.rotate[0]),n=t,e[i]=o>>>24&255,e[i+1]=o>>>16&255,e[i+2]=o>>>8&255,e[i+3]=255&o,e[i+4]=n>>>24&255,e[i+5]=n>>16&255,e[i+6]=n>>8&255,e[i+7]=255&n}return e};var scheduleA=new Array(4);scheduleA[0]=new Array(4),scheduleA[0][0]=new Array(4,0,13,15,12,14,8),scheduleA[0][1]=new Array(5,2,16,18,17,19,10),scheduleA[0][2]=new Array(6,3,23,22,21,20,9),scheduleA[0][3]=new Array(7,1,26,25,27,24,11),scheduleA[1]=new Array(4),scheduleA[1][0]=new Array(0,6,21,23,20,22,16),scheduleA[1][1]=new Array(1,4,0,2,1,3,18),scheduleA[1][2]=new Array(2,5,7,6,5,4,17),scheduleA[1][3]=new Array(3,7,10,9,11,8,19),scheduleA[2]=new Array(4),scheduleA[2][0]=new Array(4,0,13,15,12,14,8),scheduleA[2][1]=new Array(5,2,16,18,17,19,10),scheduleA[2][2]=new Array(6,3,23,22,21,20,9),scheduleA[2][3]=new Array(7,1,26,25,27,24,11),scheduleA[3]=new Array(4),scheduleA[3][0]=new Array(0,6,21,23,20,22,16),scheduleA[3][1]=new Array(1,4,0,2,1,3,18),scheduleA[3][2]=new Array(2,5,7,6,5,4,17),scheduleA[3][3]=new Array(3,7,10,9,11,8,19);var scheduleB=new Array(4);scheduleB[0]=new Array(4),scheduleB[0][0]=new Array(24,25,23,22,18),scheduleB[0][1]=new Array(26,27,21,20,22),scheduleB[0][2]=new Array(28,29,19,18,25),scheduleB[0][3]=new Array(30,31,17,16,28),scheduleB[1]=new Array(4),scheduleB[1][0]=new Array(3,2,12,13,8),scheduleB[1][1]=new Array(1,0,14,15,13),scheduleB[1][2]=new Array(7,6,8,9,3),scheduleB[1][3]=new Array(5,4,10,11,7),scheduleB[2]=new Array(4),scheduleB[2][0]=new Array(19,18,28,29,25),scheduleB[2][1]=new Array(17,16,30,31,28),scheduleB[2][2]=new Array(23,22,24,25,18),scheduleB[2][3]=new Array(21,20,26,27,22),scheduleB[3]=new Array(4),scheduleB[3][0]=new Array(8,9,7,6,3),scheduleB[3][1]=new Array(10,11,5,4,7),scheduleB[3][2]=new Array(12,13,3,2,8),scheduleB[3][3]=new Array(14,15,1,0,13),cast5.prototype.keySchedule=function(r){for(var e=new Array(8),t=new Array(32),n=0;n<4;n++){var o=4*n;e[n]=r[o]<<24|r[o+1]<<16|r[o+2]<<8|r[o+3]}for(var a=[6,7,4,5],s=0,i=0;i<2;i++)for(var h=0;h<4;h++){for(var o=0;o<4;o++){var c=scheduleA[h][o],d=e[c[1]];d^=sBox[4][e[c[2]>>>2]>>>24-8*(3&c[2])&255],d^=sBox[5][e[c[3]>>>2]>>>24-8*(3&c[3])&255],d^=sBox[6][e[c[4]>>>2]>>>24-8*(3&c[4])&255],d^=sBox[7][e[c[5]>>>2]>>>24-8*(3&c[5])&255],d^=sBox[a[o]][e[c[6]>>>2]>>>24-8*(3&c[6])&255],e[c[0]]=d}for(var o=0;o<4;o++){var u=scheduleB[h][o],d=sBox[4][e[u[0]>>>2]>>>24-8*(3&u[0])&255];d^=sBox[5][e[u[1]>>>2]>>>24-8*(3&u[1])&255],d^=sBox[6][e[u[2]>>>2]>>>24-8*(3&u[2])&255],d^=sBox[7][e[u[3]>>>2]>>>24-8*(3&u[3])&255],d^=sBox[4+o][e[u[4]>>>2]>>>24-8*(3&u[4])&255],t[s]=d,s++}}for(var n=0;n<16;n++)this.masking[n]=t[n],this.rotate[n]=31&t[16+n]};var sBox=new Array(8);sBox[0]=new Array(821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063),sBox[1]=new Array(522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321),sBox[2]=new Array(2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027),sBox[3]=new Array(2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730),sBox[4]=new Array(2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860),sBox[5]=new Array(4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975),sBox[6]=new Array(2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875),sBox[7]=new Array(3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926);const alert=console.log;var oldKeyHandler,keyRead=0,keyNext=0,keyArray=new Array(256),mouseMoveSkip=0,oldMoveHandler,mouseRead=0,mouseNext=0,mouseArray=new Array(256),s=new Array(256),x,y,bs=28,bx2=1<<bs,bm=bx2-1,bx=bx2>>1,bd=bs>>1,bdm=(1<<bd)-1,log2=Math.log(2),hexcase=0,b64pad="",chrsz=8;